from typing import List

class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        n = len(graph)
        initial.sort()
        infected_nodes = set(initial)
        uninfected_nodes = set(range(n)) - infected_nodes

        def dfs(node):
            for neighbor, connected in enumerate(graph[node]):
                if neighbor in uninfected_nodes and connected:
                    uninfected_nodes.remove(neighbor)
                    dfs(neighbor)

        rankings = []
        for node in uninfected_nodes:
            nodes_infected = set(infected_nodes)
            nodes_infected.remove(node)  # Try removing one node
            for initial_node in nodes_infected:
                dfs(initial_node)
            if len(nodes_infected) == 0:
                rankings.append([node, len(infected_nodes)])
            uninfected_nodes.add(node)

        rankings.sort(key=lambda x: (-x[1], x[0]))
        return rankings[0][0]
