from typing import List

class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        def dfs(node):
            infected.add(node)
            for neighbor, connected in enumerate(graph[node]):
                if connected and neighbor not in infected:
                    dfs(neighbor)

        n = len(graph)
        initial.sort()
        min_node = float('inf')
        max_infected = 0

        for remove_node in initial:
            infected = set()
            for i in range(n):
                if i != remove_node and graph[remove_node][i]:
                    dfs(i)

            if len(infected) > max_infected or (len(infected) == max_infected and remove_node < min_node):
                max_infected = len(infected)
                min_node = remove_node

        return min_node
